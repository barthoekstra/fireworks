<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Apply processing to all PPIs | Fireworks</title>
  <meta name="description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Apply processing to all PPIs | Fireworks" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Apply processing to all PPIs | Fireworks" />
  
  <meta name="twitter:description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  

<meta name="author" content="Bart Hoekstra" />


<meta name="date" content="2020-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="05.Processing-count-results.html"/>
<link rel="next" href="07.Composite-all-PPIs.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="assets/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="assets/VIR-1/data_stars_VIR1a3f95.txt"></script>
<script src="assets/joda-0.0.1/joda.js"></script>
<script src="assets/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/VID-1/data_stars_VIDf98d6e.txt"></script>
<script src="assets/R-1/data_stars_Rb53c91.txt"></script>
<script src="assets/overlap-1/data_stars_overlap7260eb.txt"></script>
<script src="assets/eta_sum-1/data_stars_eta_sum3f6dc1.txt"></script>
<script src="assets/eta_sum_expected-1/data_stars_eta_sum_expected374cd5.txt"></script>
<script src="assets/dist_radar-1/data_stars_dist_radar2dfb93.txt"></script>
<script src="assets/x-1/data_stars_xac5418.txt"></script>
<script src="assets/y-1/data_stars_yacf309.txt"></script>
<script src="assets/urban-1/data_stars_urban531ef6.txt"></script>
<script src="assets/agricultural-1/data_stars_agriculturalace419.txt"></script>
<script src="assets/semiopen-1/data_stars_semiopen39c01e.txt"></script>
<script src="assets/forests-1/data_stars_forestscf025b.txt"></script>
<script src="assets/wetlands-1/data_stars_wetlands8b197a.txt"></script>
<script src="assets/waterbodies-1/data_stars_waterbodies4d78a2.txt"></script>
<script src="assets/dist_urban-1/data_stars_dist_urbanba94cf.txt"></script>
<script src="assets/human_pop-1/data_stars_human_popb45e23.txt"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-document"><i class="fa fa-check"></i>How to use this document</a></li>
</ul></li>
<li class="part"><span><b>I Weather radar data</b></span></li>
<li class="chapter" data-level="1" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html"><i class="fa fa-check"></i><b>1</b> Selecting firework take-off moment</a><ul>
<li class="chapter" data-level="1.1" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#setting-up-the-processing-environment"><i class="fa fa-check"></i><b>1.1</b> Setting up the processing environment</a></li>
<li class="chapter" data-level="1.2" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#calculate-the-vertical-profiles"><i class="fa fa-check"></i><b>1.2</b> Calculate the vertical profiles</a></li>
<li class="chapter" data-level="1.3" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#generate-time-series-of-vertical-profiles"><i class="fa fa-check"></i><b>1.3</b> Generate time series of vertical profiles</a></li>
<li class="chapter" data-level="1.4" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#identifying-moment-of-take-off"><i class="fa fa-check"></i><b>1.4</b> Identifying moment of take-off</a></li>
<li class="chapter" data-level="1.5" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#determining-maximum-range-from-radar-to-detect-birds"><i class="fa fa-check"></i><b>1.5</b> Determining maximum range from radar to detect birds</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html"><i class="fa fa-check"></i><b>2</b> Radar Data Preprocessing</a><ul>
<li class="chapter" data-level="2.1" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#setting-up-the-pre-processing-environment"><i class="fa fa-check"></i><b>2.1</b> Setting-up the pre-processing environment</a></li>
<li class="chapter" data-level="2.2" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#removing-electromagnetic-interference"><i class="fa fa-check"></i><b>2.2</b> Removing electromagnetic interference</a></li>
<li class="chapter" data-level="2.3" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#filter-meteorology-using-the-depolarization-ratio"><i class="fa fa-check"></i><b>2.3</b> Filter meteorology using the depolarization ratio</a></li>
<li class="chapter" data-level="2.4" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#remove-classified-precipitation-from-polar-volumes"><i class="fa fa-check"></i><b>2.4</b> Remove classified precipitation from polar volumes</a></li>
<li class="chapter" data-level="2.5" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#filter-ground-clutter"><i class="fa fa-check"></i><b>2.5</b> Filter ground clutter</a></li>
<li class="chapter" data-level="2.6" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#range-bias-correction"><i class="fa fa-check"></i><b>2.6</b> Range-bias correction</a></li>
<li class="chapter" data-level="2.7" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#distance-to-radar"><i class="fa fa-check"></i><b>2.7</b> Distance to radar</a></li>
<li class="chapter" data-level="2.8" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#spatial-coordinates"><i class="fa fa-check"></i><b>2.8</b> Spatial coordinates</a></li>
<li class="chapter" data-level="2.9" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#visualising-range-bias-correction"><i class="fa fa-check"></i><b>2.9</b> Visualising range-bias correction</a></li>
<li class="chapter" data-level="2.10" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#preprocess-additional-scans"><i class="fa fa-check"></i><b>2.10</b> Preprocess additional scans</a></li>
</ul></li>
<li class="part"><span><b>II Land use</b></span></li>
<li class="chapter" data-level="3" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html"><i class="fa fa-check"></i><b>3</b> Annotating land use</a><ul>
<li class="chapter" data-level="3.1" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#setting-up-the-annotation-environment"><i class="fa fa-check"></i><b>3.1</b> Setting up the annotation environment</a></li>
<li class="chapter" data-level="3.2" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#converting-the-land-use-map"><i class="fa fa-check"></i><b>3.2</b> Converting the land use map</a></li>
<li class="chapter" data-level="3.3" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#adding-land-use-classifications-to-the-ppis"><i class="fa fa-check"></i><b>3.3</b> Adding land use classifications to the PPIs</a></li>
<li class="chapter" data-level="3.4" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#calculate-distance-to-nearest-urban-area"><i class="fa fa-check"></i><b>3.4</b> Calculate distance to nearest urban area</a></li>
<li class="chapter" data-level="3.5" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#add-population-density"><i class="fa fa-check"></i><b>3.5</b> Add population density</a></li>
</ul></li>
<li class="part"><span><b>III Sovon counts</b></span></li>
<li class="chapter" data-level="4" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html"><i class="fa fa-check"></i><b>4</b> Annotating count areas</a><ul>
<li class="chapter" data-level="4.1" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#setting-up-the-annotation-environment-1"><i class="fa fa-check"></i><b>4.1</b> Setting up the annotation environment</a></li>
<li class="chapter" data-level="4.2" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#annotate-ppis-with-waterbird-area-codes"><i class="fa fa-check"></i><b>4.2</b> Annotate PPIs with waterbird area codes</a></li>
<li class="chapter" data-level="4.3" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#annotate-ppis-with-point-transect-counts"><i class="fa fa-check"></i><b>4.3</b> Annotate PPIs with point-transect-counts</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html"><i class="fa fa-check"></i><b>5</b> Processing count results</a><ul>
<li class="chapter" data-level="5.1" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#setting-up-the-processing-environment-1"><i class="fa fa-check"></i><b>5.1</b> Setting up the processing environment</a></li>
<li class="chapter" data-level="5.2" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#loading-the-sovon-count-data"><i class="fa fa-check"></i><b>5.2</b> Loading the Sovon count data</a></li>
<li class="chapter" data-level="5.3" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#filteringpreprocessing-species-names"><i class="fa fa-check"></i><b>5.3</b> Filtering/preprocessing species names</a></li>
<li class="chapter" data-level="5.4" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#linking-life-history-traits-to-species"><i class="fa fa-check"></i><b>5.4</b> Linking life-history traits to species</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html"><i class="fa fa-check"></i><b>6</b> Apply processing to all PPIs</a><ul>
<li class="chapter" data-level="6.1" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#setting-up-the-environment"><i class="fa fa-check"></i><b>6.1</b> Setting-up the environment</a></li>
<li class="chapter" data-level="6.2" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#load-the-reference-ppis"><i class="fa fa-check"></i><b>6.2</b> Load the reference PPIs</a></li>
<li class="chapter" data-level="6.3" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#copy-annotations-from-reference-ppis-to-other-ppis"><i class="fa fa-check"></i><b>6.3</b> Copy annotations from reference PPIs to other PPIs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html"><i class="fa fa-check"></i><b>7</b> Composite all PPIs</a><ul>
<li class="chapter" data-level="7.1" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#setting-up-the-environment-1"><i class="fa fa-check"></i><b>7.1</b> Setting-up the environment</a></li>
<li class="chapter" data-level="7.2" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#generating-the-composite-ppis"><i class="fa fa-check"></i><b>7.2</b> Generating the composite PPIs</a></li>
<li class="chapter" data-level="7.3" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#visualising-the-composites"><i class="fa fa-check"></i><b>7.3</b> Visualising the composites</a></li>
</ul></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="8" data-path="A1.Generating-VPs-for-Den-Helder-radar.html"><a href="A1.Generating-VPs-for-Den-Helder-radar.html"><i class="fa fa-check"></i><b>8</b> Generating vertical profiles for Den Helder radar</a></li>
<li class="part"><span><b>V Other</b></span></li>
<li class="chapter" data-level="9" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fireworks</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="apply-processing-to-all-ppis" class="section level1">
<h1><span class="header-section-number">6</span> Apply processing to all PPIs</h1>
<p>We have so far explained the processing ‘pipeline’ for the PPIs for Herwijnen and Den Helder radars, but have only applied this to a single moment in time, a single volume scan. Now we will apply the processing to all other available PPIs by simply copying over the annotations.</p>
<ol style="list-style-type: decimal">
<li>Pre-processed the radar data, by removing clutter and applying the range-bias correction <span class="citation">(Kranstauber et al. <a href="#ref-kranstauber2020">2020</a>)</span>.</li>
<li>Annotated the PPIs with land use class proportions, distance to urban areas and human population.</li>
<li>Annotated the PPIs with corresponding count locations for the Sovon data.</li>
<li>Connected the Sovon count data with life-history characteristics for the species contained within.</li>
</ol>
<div id="setting-up-the-environment" class="section level2">
<h2><span class="header-section-number">6.1</span> Setting-up the environment</h2>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="kw">library</span>(kableExtra)</a></code></pre></div>
</div>
<div id="load-the-reference-ppis" class="section level2">
<h2><span class="header-section-number">6.2</span> Load the reference PPIs</h2>
<p>Two PPIs have been processed all the way and those will be our ‘reference’ PPIs from which we copy the data over to the other PPIs which have not had the same treatment.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">ppi_hrw &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/processed/corrected-ppis-lu-sovon/corrected_ppi_hrw_lu_sovon.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb119-2" data-line-number="2">ppi_dhl &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/processed/corrected-ppis-lu-sovon/corrected_ppi_dhl_lu_sovon.RDS&quot;</span>)</a></code></pre></div>
</div>
<div id="copy-annotations-from-reference-ppis-to-other-ppis" class="section level2">
<h2><span class="header-section-number">6.3</span> Copy annotations from reference PPIs to other PPIs</h2>
<p>We select the variables related to land use, distance to urbanized areas and population density, waterbird counts and PTT counts and add these to the PPIs that contain just the variables resulting from the range-bias correction <span class="citation">(Kranstauber et al. <a href="#ref-kranstauber2020">2020</a>)</span>. While we are at it, we will also create dataframes containing all the information within the PPIs, to use for later modelling exercises.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">columns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;urban&quot;</span>, <span class="st">&quot;agricultural&quot;</span>, <span class="st">&quot;semiopen&quot;</span>, <span class="st">&quot;forests&quot;</span>, <span class="st">&quot;wetlands&quot;</span>, <span class="st">&quot;waterbodies&quot;</span>,</a>
<a class="sourceLine" id="cb120-2" data-line-number="2">             <span class="st">&quot;dist_urban&quot;</span>, <span class="st">&quot;human_pop&quot;</span>)</a>
<a class="sourceLine" id="cb120-3" data-line-number="3"></a>
<a class="sourceLine" id="cb120-4" data-line-number="4">hrw &lt;-<span class="st"> </span>ppi_hrw<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">all_of</span>(columns))</a>
<a class="sourceLine" id="cb120-6" data-line-number="6"></a>
<a class="sourceLine" id="cb120-7" data-line-number="7">dhl &lt;-<span class="st"> </span>ppi_dhl<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">all_of</span>(columns))</a>
<a class="sourceLine" id="cb120-9" data-line-number="9"></a>
<a class="sourceLine" id="cb120-10" data-line-number="10">hrw_all &lt;-<span class="st"> </span>ppi_hrw<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb120-12" data-line-number="12"></a>
<a class="sourceLine" id="cb120-13" data-line-number="13">dhl_all &lt;-<span class="st"> </span>ppi_dhl<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-14" data-line-number="14"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb120-15" data-line-number="15"></a>
<a class="sourceLine" id="cb120-16" data-line-number="16">hrw_ppis &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="kw">file.path</span>(<span class="st">&quot;data/processed/corrected-ppis&quot;</span>, <span class="st">&quot;*NL62*&quot;</span>))</a>
<a class="sourceLine" id="cb120-17" data-line-number="17">dhl_ppis &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="kw">file.path</span>(<span class="st">&quot;data/processed/corrected-ppis&quot;</span>, <span class="st">&quot;*NL61*&quot;</span>))</a>
<a class="sourceLine" id="cb120-18" data-line-number="18"></a>
<a class="sourceLine" id="cb120-19" data-line-number="19"><span class="cf">for</span> (ppi_path <span class="cf">in</span> hrw_ppis) {</a>
<a class="sourceLine" id="cb120-20" data-line-number="20">  ppi &lt;-<span class="st"> </span><span class="kw">readRDS</span>(ppi_path)</a>
<a class="sourceLine" id="cb120-21" data-line-number="21">  ppi<span class="op">$</span>data<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(ppi<span class="op">$</span>data<span class="op">@</span>data, hrw)</a>
<a class="sourceLine" id="cb120-22" data-line-number="22">  <span class="kw">saveRDS</span>(ppi, <span class="dt">file =</span> <span class="kw">paste</span>(<span class="st">&quot;data/processed/final-ppis/&quot;</span>, <span class="kw">basename</span>(ppi_path), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb120-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb120-24" data-line-number="24">  ppi<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-25" data-line-number="25"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">datetime =</span> <span class="kw">as.POSIXct</span>(ppi<span class="op">$</span>datetime),</a>
<a class="sourceLine" id="cb120-26" data-line-number="26">           <span class="dt">pixel =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-27" data-line-number="27"><span class="st">    </span><span class="kw">bind_rows</span>(hrw_all) -&gt;<span class="st"> </span>hrw_all</a>
<a class="sourceLine" id="cb120-28" data-line-number="28">}</a>
<a class="sourceLine" id="cb120-29" data-line-number="29"></a>
<a class="sourceLine" id="cb120-30" data-line-number="30"><span class="cf">for</span> (ppi_path <span class="cf">in</span> dhl_ppis) {</a>
<a class="sourceLine" id="cb120-31" data-line-number="31">  ppi &lt;-<span class="st"> </span><span class="kw">readRDS</span>(ppi_path)</a>
<a class="sourceLine" id="cb120-32" data-line-number="32">  ppi<span class="op">$</span>data<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(ppi<span class="op">$</span>data<span class="op">@</span>data, dhl)</a>
<a class="sourceLine" id="cb120-33" data-line-number="33">  <span class="kw">saveRDS</span>(ppi, <span class="dt">file =</span> <span class="kw">paste</span>(<span class="st">&quot;data/processed/final-ppis/&quot;</span>, <span class="kw">basename</span>(ppi_path), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb120-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb120-35" data-line-number="35">  ppi<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-36" data-line-number="36"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">datetime =</span> <span class="kw">as.POSIXct</span>(ppi<span class="op">$</span>datetime),</a>
<a class="sourceLine" id="cb120-37" data-line-number="37">           <span class="dt">pixel =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-38" data-line-number="38"><span class="st">    </span><span class="kw">bind_rows</span>(dhl_all) -&gt;<span class="st"> </span>dhl_all</a>
<a class="sourceLine" id="cb120-39" data-line-number="39">}</a>
<a class="sourceLine" id="cb120-40" data-line-number="40"></a>
<a class="sourceLine" id="cb120-41" data-line-number="41"><span class="kw">saveRDS</span>(hrw_all, <span class="dt">file =</span> <span class="st">&quot;data/processed/hrw.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb120-42" data-line-number="42"><span class="kw">saveRDS</span>(dhl_all, <span class="dt">file =</span> <span class="st">&quot;data/processed/dhl.RDS&quot;</span>)</a></code></pre></div>
<p><code>data/processed/hrw.RDS</code> and <code>data/processed/dhl.RDS</code> now contain all the PPI rows for each radar respectively.</p>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-kranstauber2020">
<p>Kranstauber, Bart, Willem Bouten, Hidde Leijnse, Berend-Christiaan Wijers, Liesbeth Verlinden, Judy Shamoun-Baranes, and Adriaan M Dokter. 2020. “High-Resolution Spatial Distribution of Bird Movements Estimated from a Weather Radar Network.” <em>Remote Sensing</em> 12 (4). Multidisciplinary Digital Publishing Institute: 635. <a href="https://doi.org/10.3390/rs12040635">https://doi.org/10.3390/rs12040635</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="05.Processing-count-results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="07.Composite-all-PPIs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/barthoekstra/fireworks/edit/master/06.Applying-annotations-to-all-PPIs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/barthoekstra/fireworks/blob/master/06.Applying-annotations-to-all-PPIs.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
