<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Annotating count areas | Fireworks</title>
  <meta name="description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Annotating count areas | Fireworks" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Annotating count areas | Fireworks" />
  
  <meta name="twitter:description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  

<meta name="author" content="Bart Hoekstra" />


<meta name="date" content="2020-10-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="03.Annotate-land-use.html"/>
<link rel="next" href="05.Processing-count-results.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="assets/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="assets/layer.1-1/data_stars_layer16d1478.txt"></script>
<script src="assets/joda-0.0.1/joda.js"></script>
<script src="assets/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/layer.2-1/data_stars_layer2eb4a93.txt"></script>
<script src="assets/layer.3-1/data_stars_layer317d950.txt"></script>
<script src="assets/layer.4-1/data_stars_layer4caf51d.txt"></script>
<script src="assets/layer.5-1/data_stars_layer580e295.txt"></script>
<script src="assets/layer.6-1/data_stars_layer6ef038d.txt"></script>
<script src="assets/layer.7-1/data_stars_layer7364f1b.txt"></script>
<script src="assets/layer.8-1/data_stars_layer884e0a1.txt"></script>
<script src="assets/layer.9-1/data_stars_layer97d5f83.txt"></script>
<script src="assets/layer.10-1/data_stars_layer10871da5.txt"></script>
<script src="assets/urban-1/data_stars_urban2bef87.txt"></script>
<script src="assets/agricultural-1/data_stars_agricultural293ad5.txt"></script>
<script src="assets/semiopen-1/data_stars_semiopen31d5c6.txt"></script>
<script src="assets/forests-1/data_stars_forestsdec7f1.txt"></script>
<script src="assets/wetlands-1/data_stars_wetlands86a0e3.txt"></script>
<script src="assets/waterbodies-1/data_stars_waterbodiesec61d2.txt"></script>
<script src="assets/dist_urban-1/data_stars_dist_urban961c43.txt"></script>
<script src="assets/human_pop-1/data_stars_human_pop6eaf30.txt"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<script src="assets/resid-1/data_stars_stars715e20.txt"></script>
<link href="assets/jquery-ui-1.10.3/jquery-ui-1.10.3.custom.min.css" rel="stylesheet" />
<script src="assets/jquery-ui-1.10.3/jquery-ui-1.10.3.custom.min.js"></script>
<link href="assets/opacity-1.0.0/Control.Opacity.css" rel="stylesheet" />
<script src="assets/opacity-1.0.0/Control.Opacity.js"></script>
<script src="assets/local_sa-1/data_stars_local_sa6eb47d.txt"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-document"><i class="fa fa-check"></i>How to use this document</a></li>
</ul></li>
<li class="part"><span><b>I Weather radar data</b></span></li>
<li class="chapter" data-level="1" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html"><i class="fa fa-check"></i><b>1</b> Selecting firework take-off moment</a><ul>
<li class="chapter" data-level="1.1" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#processing-environment"><i class="fa fa-check"></i><b>1.1</b> Processing environment</a></li>
<li class="chapter" data-level="1.2" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#calculate-the-vertical-profiles"><i class="fa fa-check"></i><b>1.2</b> Calculate the vertical profiles</a></li>
<li class="chapter" data-level="1.3" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#generate-time-series-of-vertical-profiles"><i class="fa fa-check"></i><b>1.3</b> Generate time series of vertical profiles</a></li>
<li class="chapter" data-level="1.4" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#identifying-moment-of-take-off"><i class="fa fa-check"></i><b>1.4</b> Identifying moment of take-off</a></li>
<li class="chapter" data-level="1.5" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#determining-maximum-range-from-radar-to-detect-birds"><i class="fa fa-check"></i><b>1.5</b> Determining maximum range from radar to detect birds</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html"><i class="fa fa-check"></i><b>2</b> Radar Data Preprocessing</a><ul>
<li class="chapter" data-level="2.1" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#processing-environment-1"><i class="fa fa-check"></i><b>2.1</b> Processing environment</a></li>
<li class="chapter" data-level="2.2" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#removing-electromagnetic-interference"><i class="fa fa-check"></i><b>2.2</b> Removing electromagnetic interference</a></li>
<li class="chapter" data-level="2.3" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#filter-meteorology-using-the-depolarization-ratio"><i class="fa fa-check"></i><b>2.3</b> Filter meteorology using the depolarization ratio</a></li>
<li class="chapter" data-level="2.4" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#remove-classified-precipitation-from-polar-volumes"><i class="fa fa-check"></i><b>2.4</b> Remove classified precipitation from polar volumes</a></li>
<li class="chapter" data-level="2.5" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#filter-ground-clutter"><i class="fa fa-check"></i><b>2.5</b> Filter ground clutter</a></li>
<li class="chapter" data-level="2.6" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#range-bias-correction"><i class="fa fa-check"></i><b>2.6</b> Range-bias correction</a></li>
<li class="chapter" data-level="2.7" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#keep-biologymeteorology-classification"><i class="fa fa-check"></i><b>2.7</b> Keep biology/meteorology classification</a></li>
<li class="chapter" data-level="2.8" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#distance-to-radar"><i class="fa fa-check"></i><b>2.8</b> Distance to radar</a></li>
<li class="chapter" data-level="2.9" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#spatial-coordinates"><i class="fa fa-check"></i><b>2.9</b> Spatial coordinates</a></li>
<li class="chapter" data-level="2.10" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#visualising-range-bias-correction"><i class="fa fa-check"></i><b>2.10</b> Visualising range-bias correction</a></li>
<li class="chapter" data-level="2.11" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#preprocess-additional-scans"><i class="fa fa-check"></i><b>2.11</b> Preprocess additional scans</a></li>
</ul></li>
<li class="part"><span><b>II Land use</b></span></li>
<li class="chapter" data-level="3" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html"><i class="fa fa-check"></i><b>3</b> Annotating land use</a><ul>
<li class="chapter" data-level="3.1" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#processing-environment-2"><i class="fa fa-check"></i><b>3.1</b> Processing environment</a></li>
<li class="chapter" data-level="3.2" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#converting-the-land-use-map"><i class="fa fa-check"></i><b>3.2</b> Converting the land use map</a></li>
<li class="chapter" data-level="3.3" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#adding-land-use-classifications-to-the-ppis"><i class="fa fa-check"></i><b>3.3</b> Adding land use classifications to the PPIs</a></li>
<li class="chapter" data-level="3.4" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#calculate-distance-to-nearest-urban-area"><i class="fa fa-check"></i><b>3.4</b> Calculate distance to nearest urban area</a></li>
<li class="chapter" data-level="3.5" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#add-population-density"><i class="fa fa-check"></i><b>3.5</b> Add population density</a></li>
</ul></li>
<li class="part"><span><b>III Sovon counts</b></span></li>
<li class="chapter" data-level="4" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html"><i class="fa fa-check"></i><b>4</b> Annotating count areas</a><ul>
<li class="chapter" data-level="4.1" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#processing-environment-3"><i class="fa fa-check"></i><b>4.1</b> Processing environment</a></li>
<li class="chapter" data-level="4.2" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#annotate-ppis-with-waterbird-area-codes"><i class="fa fa-check"></i><b>4.2</b> Annotate PPIs with waterbird area codes</a></li>
<li class="chapter" data-level="4.3" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#annotate-ppis-with-point-transect-counts"><i class="fa fa-check"></i><b>4.3</b> Annotate PPIs with point-transect-counts</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html"><i class="fa fa-check"></i><b>5</b> Processing count results</a><ul>
<li class="chapter" data-level="5.1" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#processing-environment-4"><i class="fa fa-check"></i><b>5.1</b> Processing environment</a></li>
<li class="chapter" data-level="5.2" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#loading-the-sovon-count-data"><i class="fa fa-check"></i><b>5.2</b> Loading the Sovon count data</a></li>
<li class="chapter" data-level="5.3" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#filteringpreprocessing-species-names"><i class="fa fa-check"></i><b>5.3</b> Filtering/preprocessing species names</a></li>
<li class="chapter" data-level="5.4" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#adding-vernacular-family-names"><i class="fa fa-check"></i><b>5.4</b> Adding vernacular family names</a></li>
<li class="chapter" data-level="5.5" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#linking-life-history-traits-to-species"><i class="fa fa-check"></i><b>5.5</b> Linking life-history traits to species</a></li>
<li class="chapter" data-level="5.6" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#calculating-total-bird-biomass"><i class="fa fa-check"></i><b>5.6</b> Calculating total bird biomass</a></li>
<li class="chapter" data-level="5.7" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#calculating-proportions-across-bird-families"><i class="fa fa-check"></i><b>5.7</b> Calculating proportions across bird families</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html"><i class="fa fa-check"></i><b>6</b> Apply processing to all PPIs</a><ul>
<li class="chapter" data-level="6.1" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#processing-environment-5"><i class="fa fa-check"></i><b>6.1</b> Processing environment</a></li>
<li class="chapter" data-level="6.2" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#load-the-reference-ppis"><i class="fa fa-check"></i><b>6.2</b> Load the reference PPIs</a></li>
<li class="chapter" data-level="6.3" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#add-biomass-to-reference-ppis"><i class="fa fa-check"></i><b>6.3</b> Add biomass to reference PPIs</a></li>
<li class="chapter" data-level="6.4" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#copy-annotations-from-reference-ppis-to-other-ppis"><i class="fa fa-check"></i><b>6.4</b> Copy annotations from reference PPIs to other PPIs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html"><i class="fa fa-check"></i><b>7</b> Composite all PPIs</a><ul>
<li class="chapter" data-level="7.1" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#processing-environment-6"><i class="fa fa-check"></i><b>7.1</b> Processing environment</a></li>
<li class="chapter" data-level="7.2" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#generating-the-composite-ppis"><i class="fa fa-check"></i><b>7.2</b> Generating the composite PPIs</a></li>
<li class="chapter" data-level="7.3" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#visualising-the-composites"><i class="fa fa-check"></i><b>7.3</b> Visualising the composites</a></li>
</ul></li>
<li class="part"><span><b>IV Fireworks disturbance</b></span></li>
<li class="chapter" data-level="8" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html"><i class="fa fa-check"></i><b>8</b> Modelling fireworks disturbance</a><ul>
<li class="chapter" data-level="8.1" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#processing-environment-7"><i class="fa fa-check"></i><b>8.1</b> Processing environment</a></li>
<li class="chapter" data-level="8.2" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#preparing-a-dataset-for-modelling"><i class="fa fa-check"></i><b>8.2</b> Preparing a dataset for modelling</a></li>
<li class="chapter" data-level="8.3" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#determine-model-resolution-based-on-performance-in-simple-total_biomass-model"><i class="fa fa-check"></i><b>8.3</b> Determine model resolution based on performance in simple <code>total_biomass</code> model</a></li>
<li class="chapter" data-level="8.4" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#check-for-correlations-among-predictors"><i class="fa fa-check"></i><b>8.4</b> Check for correlations among predictors</a></li>
<li class="chapter" data-level="8.5" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#correlated-land-use-proportions"><i class="fa fa-check"></i><b>8.5</b> Correlated land use proportions</a></li>
<li class="chapter" data-level="8.6" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#determine-the-most-suitable-proxy-for-disturbance"><i class="fa fa-check"></i><b>8.6</b> Determine the most suitable proxy for disturbance</a></li>
<li class="chapter" data-level="8.7" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#determine-the-optimal-number-of-boosting-steps"><i class="fa fa-check"></i><b>8.7</b> Determine the optimal number of boosting steps</a></li>
<li class="chapter" data-level="8.8" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#variable-importance"><i class="fa fa-check"></i><b>8.8</b> Variable importance</a></li>
<li class="chapter" data-level="8.9" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#model-marginal-effects"><i class="fa fa-check"></i><b>8.9</b> Model marginal effects</a></li>
<li class="chapter" data-level="8.10" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>8.10</b> Spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html"><i class="fa fa-check"></i><b>9</b> Quantifying model uncertainty</a><ul>
<li class="chapter" data-level="9.1" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#processing-environment-8"><i class="fa fa-check"></i><b>9.1</b> Processing environment</a></li>
<li class="chapter" data-level="9.2" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#load-the-constructed-model"><i class="fa fa-check"></i><b>9.2</b> Load the constructed model</a></li>
<li class="chapter" data-level="9.3" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#bootstrapped-uncertainty-analysis"><i class="fa fa-check"></i><b>9.3</b> Bootstrapped uncertainty analysis</a></li>
<li class="chapter" data-level="9.4" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#recombine-bootstrapped-results"><i class="fa fa-check"></i><b>9.4</b> Recombine bootstrapped results</a></li>
</ul></li>
<li class="part"><span><b>V Figures</b></span></li>
<li class="chapter" data-level="10" data-path="10.Figures-1-Data-overview.html"><a href="10.Figures-1-Data-overview.html"><i class="fa fa-check"></i><b>10</b> Figure 1: Data overview</a><ul>
<li class="chapter" data-level="10.1" data-path="10.Figures-1-Data-overview.html"><a href="10.Figures-1-Data-overview.html#processing-environment-9"><i class="fa fa-check"></i><b>10.1</b> Processing environment</a></li>
<li class="chapter" data-level="10.2" data-path="10.Figures-1-Data-overview.html"><a href="10.Figures-1-Data-overview.html#workflow"><i class="fa fa-check"></i><b>10.2</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html"><i class="fa fa-check"></i><b>11</b> Figure 2: Model output</a><ul>
<li class="chapter" data-level="11.1" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#processing-environment-10"><i class="fa fa-check"></i><b>11.1</b> Processing environment</a></li>
<li class="chapter" data-level="11.2" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#variable-importance-1"><i class="fa fa-check"></i><b>11.2</b> Variable importance</a></li>
<li class="chapter" data-level="11.3" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#visualise-marginal-effects"><i class="fa fa-check"></i><b>11.3</b> Visualise marginal effects</a></li>
<li class="chapter" data-level="11.4" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#all-marginal-effects"><i class="fa fa-check"></i><b>11.4</b> All marginal effects</a></li>
</ul></li>
<li class="part"><span><b>VI Visualizations</b></span></li>
<li class="chapter" data-level="12" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html"><i class="fa fa-check"></i><b>12</b> Visualizing species composition</a></li>
<li class="part"><span><b>VII Appendix</b></span></li>
<li class="chapter" data-level="13" data-path="A1.Generating-VPs-for-Den-Helder-radar.html"><a href="A1.Generating-VPs-for-Den-Helder-radar.html"><i class="fa fa-check"></i><b>13</b> Generating vertical profiles for Den Helder radar</a></li>
<li class="part"><span><b>VIII Other</b></span></li>
<li class="chapter" data-level="14" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fireworks</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="annotating-count-areas" class="section level1">
<h1><span class="header-section-number">4</span> Annotating count areas</h1>
<p>We have data for the following counts provided by Sovon:</p>
<ol style="list-style-type: decimal">
<li>Waterbird counts with a shapefile containing the surveyed areas and an <code>xlsx</code> file with the count results. Both can be linked using the identifiers contained in both datasets.</li>
<li>PTT counts, or point transect counts, contained within an <code>xlsx</code> file with the routes and all bird observations at an <span class="math inline">\((X, Y)\)</span> location.</li>
</ol>
<p>To make processing efficient, we will ‘annotate’ the PPIs with the corresponding area codes for the waterbird counts and some identifier for the PTT counts. Doing so, we can later on calculate relevant count-based parameters (e.g. bird biomass, etc.) and ‘join’ these by the corresponding identifiers.</p>
<div id="processing-environment-3" class="section level2">
<h2><span class="header-section-number">4.1</span> Processing environment</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">library</span>(bioRad)</a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="kw">library</span>(stars)</a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb78-7" data-line-number="7"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb78-8" data-line-number="8"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb78-9" data-line-number="9"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb78-10" data-line-number="10"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb78-11" data-line-number="11"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb78-12" data-line-number="12"><span class="kw">library</span>(fasterize)</a></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">ppi_hrw &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/processed/corrected_ppi_hrw_lu.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb79-2" data-line-number="2">ppi_dhl &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/processed/corrected_ppi_dhl_lu.RDS&quot;</span>)</a></code></pre></div>
</div>
<div id="annotate-ppis-with-waterbird-area-codes" class="section level2">
<h2><span class="header-section-number">4.2</span> Annotate PPIs with waterbird area codes</h2>
<p>We rename the veriables retained in the shapefile to English and add a numerical <code>wb_area_id</code> which we can use to link the information retained in the shapefiles with the rasterized waterbird areas. All shapefiles are transformed to the CRS of the PPIs.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">wb_areas &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/raw/sovon/wavo_telgebieden.shp&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">wb_area_nr =</span> GEBIEDNR, <span class="dt">wb_area_ha =</span> OPPHA, <span class="dt">xcoor =</span> XCOOR, <span class="dt">ycoor =</span> YCOOR)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3">wb_areas<span class="op">$</span>wb_area_id &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(wb_areas<span class="op">$</span>wb_area_nr))</a>
<a class="sourceLine" id="cb80-4" data-line-number="4"></a>
<a class="sourceLine" id="cb80-5" data-line-number="5">wb_areas_hrw &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wb_areas, ppi_hrw<span class="op">$</span>data<span class="op">@</span>proj4string)</a>
<a class="sourceLine" id="cb80-6" data-line-number="6">wb_areas_dhl &lt;-<span class="st"> </span><span class="kw">st_transform</span>(wb_areas, ppi_dhl<span class="op">$</span>data<span class="op">@</span>proj4string)</a></code></pre></div>
<pre><code>## Reading layer `wavo_telgebieden&#39; from data source `/mnt/volume_ams3_01/raw/sovon/wavo_telgebieden.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 4131 features and 4 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 13551.48 ymin: 307546.8 xmax: 278027 ymax: 622790
## proj4string:    +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs</code></pre>
<p>We rasterize specifically the newly created <code>wb_area_id</code> (as this is already a numerical and not categorical value like <code>wb_area_nr</code>) following the ‘template’ of the existing PPIs.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">tpl_hrw &lt;-<span class="st"> </span><span class="kw">st_as_stars</span>(<span class="kw">st_bbox</span>(ppi_hrw<span class="op">$</span>data), <span class="dt">dx =</span> ppi_hrw<span class="op">$</span>data<span class="op">@</span>grid<span class="op">@</span>cellsize[<span class="dv">1</span>], <span class="dt">dy =</span> ppi_hrw<span class="op">$</span>data<span class="op">@</span>grid<span class="op">@</span>cellsize[<span class="dv">2</span>], <span class="dt">values =</span> <span class="ot">NA_real_</span>)</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">tpl_dhl &lt;-<span class="st"> </span><span class="kw">st_as_stars</span>(<span class="kw">st_bbox</span>(ppi_dhl<span class="op">$</span>data), <span class="dt">dx =</span> ppi_dhl<span class="op">$</span>data<span class="op">@</span>grid<span class="op">@</span>cellsize[<span class="dv">1</span>], <span class="dt">dy =</span> ppi_dhl<span class="op">$</span>data<span class="op">@</span>grid<span class="op">@</span>cellsize[<span class="dv">2</span>], <span class="dt">values =</span> <span class="ot">NA_real_</span>)</a>
<a class="sourceLine" id="cb82-3" data-line-number="3"></a>
<a class="sourceLine" id="cb82-4" data-line-number="4">wb_areas_rasterized_hrw &lt;-<span class="st"> </span><span class="kw">st_rasterize</span>(wb_areas_hrw[<span class="st">&quot;wb_area_id&quot;</span>], <span class="dt">template =</span> tpl_hrw)</a>
<a class="sourceLine" id="cb82-5" data-line-number="5">wb_areas_rasterized_dhl &lt;-<span class="st"> </span><span class="kw">st_rasterize</span>(wb_areas_dhl[<span class="st">&quot;wb_area_id&quot;</span>], <span class="dt">template =</span> tpl_dhl)</a></code></pre></div>
<p>Let’s see how that’s gone so far.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="kw">plot</span>(wb_areas_rasterized_hrw, <span class="dt">main =</span> <span class="st">&quot;Herwijnen: wb_area_id&quot;</span>)</a>
<a class="sourceLine" id="cb83-3" data-line-number="3"><span class="kw">plot</span>(wb_areas_rasterized_dhl, <span class="dt">main =</span> <span class="st">&quot;Den Helder: wb_area_id&quot;</span>)</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/show_rasterized_waterbird_areas-1.png" width="672" /><img src="Fireworks_files/figure-html/show_rasterized_waterbird_areas-2.png" width="672" /></p>
<p>Visually that seems to have gone well, now let’s make sure the rasterized waterbird areas share the same grid as the PPI ‘rasters’.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">compareRaster</span>(<span class="kw">as</span>(wb_areas_rasterized_hrw, <span class="st">&quot;Raster&quot;</span>), <span class="kw">as</span>(ppi_hrw<span class="op">$</span>data, <span class="st">&quot;RasterLayer&quot;</span>), <span class="dt">extent =</span> <span class="ot">TRUE</span>, <span class="dt">rowcol =</span> <span class="ot">TRUE</span>, <span class="dt">crs =</span> <span class="ot">TRUE</span>, <span class="dt">res =</span> <span class="ot">TRUE</span>, <span class="dt">orig =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="kw">compareRaster</span>(<span class="kw">as</span>(wb_areas_rasterized_dhl, <span class="st">&quot;Raster&quot;</span>), <span class="kw">as</span>(ppi_dhl<span class="op">$</span>data, <span class="st">&quot;RasterLayer&quot;</span>), <span class="dt">extent =</span> <span class="ot">TRUE</span>, <span class="dt">rowcol =</span> <span class="ot">TRUE</span>, <span class="dt">crs =</span> <span class="ot">TRUE</span>, <span class="dt">res =</span> <span class="ot">TRUE</span>, <span class="dt">orig =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] TRUE
## [1] TRUE</code></pre>
<p>Twice a <code>TRUE</code>, so the rasters are identical (except for the values), so we can merge the datasets using a <code>join</code> on the <code>wb_area_id</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="co"># Add the wb_area_id to the PPIs</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2">ppi_hrw<span class="op">$</span>data<span class="op">$</span>wb_area_id &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">as.data.frame</span>(<span class="kw">as</span>(wb_areas_rasterized_hrw, <span class="st">&quot;Raster&quot;</span>)))</a>
<a class="sourceLine" id="cb86-3" data-line-number="3">ppi_dhl<span class="op">$</span>data<span class="op">$</span>wb_area_id &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">as.data.frame</span>(<span class="kw">as</span>(wb_areas_rasterized_dhl, <span class="st">&quot;Raster&quot;</span>)))</a>
<a class="sourceLine" id="cb86-4" data-line-number="4"></a>
<a class="sourceLine" id="cb86-5" data-line-number="5"><span class="co"># Join the additional contents of the shapefiles</span></a>
<a class="sourceLine" id="cb86-6" data-line-number="6">ppi_hrw<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="st">  </span><span class="kw">left_join</span>(dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">as.data.frame</span>(wb_areas_hrw), wb_area_id, wb_area_nr, wb_area_ha), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;wb_area_id&quot;</span> =<span class="st"> &quot;wb_area_id&quot;</span>)) -&gt;<span class="st"> </span>ppi_hrw<span class="op">$</span>data<span class="op">@</span>data</a>
<a class="sourceLine" id="cb86-8" data-line-number="8">ppi_hrw<span class="op">$</span>data<span class="op">$</span>geometry &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb86-9" data-line-number="9"></a>
<a class="sourceLine" id="cb86-10" data-line-number="10">ppi_dhl<span class="op">$</span>data<span class="op">@</span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-11" data-line-number="11"><span class="st">  </span><span class="kw">left_join</span>(dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">as.data.frame</span>(wb_areas_dhl), wb_area_id, wb_area_nr, wb_area_ha), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;wb_area_id&quot;</span> =<span class="st"> &quot;wb_area_id&quot;</span>)) -&gt;<span class="st"> </span>ppi_dhl<span class="op">$</span>data<span class="op">@</span>data</a>
<a class="sourceLine" id="cb86-12" data-line-number="12">ppi_dhl<span class="op">$</span>data<span class="op">$</span>geometry &lt;-<span class="st"> </span><span class="ot">NULL</span></a></code></pre></div>
<p>Let’s verify if that occurred as planned.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">plot</span>(ppi_hrw, <span class="dt">param =</span> <span class="st">&quot;wb_area_id&quot;</span>, <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(ppi_hrw<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>wb_area_id, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="kw">max</span>(ppi_hrw<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>wb_area_id, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="kw">plot</span>(ppi_dhl, <span class="dt">param =</span> <span class="st">&quot;wb_area_id&quot;</span>, <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(ppi_dhl<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>wb_area_id, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="kw">max</span>(ppi_dhl<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>wb_area_id, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/plot_waterbirds_ppis-1.png" width="672" /><img src="Fireworks_files/figure-html/plot_waterbirds_ppis-2.png" width="672" /></p>
<p>This looks very comparable to the plots of the rasterized scans above and <code>wb_area_id</code> shows similar areas in similar colors, so this worked fine.</p>
</div>
<div id="annotate-ppis-with-point-transect-counts" class="section level2">
<h2><span class="header-section-number">4.3</span> Annotate PPIs with point-transect-counts</h2>
<p>The PTT point transect counts are organized by routes, which consist of a few points along a transect/route. We can follow the same approach as above with the waterbird counts, by first creating coverage shapes (like the shapefile features for the waterbird areas) for each of the routes. Using the convex hull of the points within a route seems like a good starting point to convert these points to areas. However, in that case it would appear as if birds are only counted when looking ‘inwards’ to this shape. By buffering these convex hulls with a radius of the average distance between successive points, a more representative coverage area can be generated that generalises well across landscapes (e.g. the area covered in a dense forest would tend to be smaller than in open agricultural areas).</p>
<div id="loading-ptt-points" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Loading PTT points</h3>
<p>We load the PTT data directly from the <code>xlsx</code> file provided by Sovon and rename the variables to English.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">ptt &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/raw/sovon/tel_dec_jan_1718.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;ptt&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">count_id =</span> tellingid, <span class="dt">route =</span> route, <span class="dt">count_point =</span> telpunt, <span class="dt">season =</span> seizoen, <span class="dt">year =</span> teljaar, <span class="dt">month =</span> maand, <span class="dt">day =</span> dag, <span class="dt">species =</span> soort, <span class="dt">number =</span> aantal)</a>
<a class="sourceLine" id="cb88-3" data-line-number="3"><span class="kw">head</span>(ptt, <span class="dv">10</span>)</a></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">count_id</th>
<th align="right">route</th>
<th align="right">count_point</th>
<th align="right">season</th>
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">euring</th>
<th align="left">species</th>
<th align="right">number</th>
<th align="right">xcoor</th>
<th align="right">ycoor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">720</td>
<td align="left">Aalscholver</td>
<td align="right">2</td>
<td align="right">246342</td>
<td align="right">520763</td>
</tr>
<tr class="even">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">5920</td>
<td align="left">Zilvermeeuw</td>
<td align="right">18</td>
<td align="right">246342</td>
<td align="right">520763</td>
</tr>
<tr class="odd">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">6700</td>
<td align="left">Houtduif</td>
<td align="right">1</td>
<td align="right">246342</td>
<td align="right">520763</td>
</tr>
<tr class="even">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">11870</td>
<td align="left">Merel</td>
<td align="right">4</td>
<td align="right">246342</td>
<td align="right">520763</td>
</tr>
<tr class="odd">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">15630</td>
<td align="left">Roek</td>
<td align="right">24</td>
<td align="right">246342</td>
<td align="right">520763</td>
</tr>
<tr class="even">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">6700</td>
<td align="left">Houtduif</td>
<td align="right">1</td>
<td align="right">246357</td>
<td align="right">522178</td>
</tr>
<tr class="odd">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">11870</td>
<td align="left">Merel</td>
<td align="right">1</td>
<td align="right">246357</td>
<td align="right">522178</td>
</tr>
<tr class="even">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">15600</td>
<td align="left">Kauw</td>
<td align="right">6</td>
<td align="right">246357</td>
<td align="right">522178</td>
</tr>
<tr class="odd">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">15630</td>
<td align="left">Roek</td>
<td align="right">78</td>
<td align="right">246357</td>
<td align="right">522178</td>
</tr>
<tr class="even">
<td align="right">80917</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2017</td>
<td align="right">2017</td>
<td align="right">12</td>
<td align="right">23</td>
<td align="right">14620</td>
<td align="left">Pimpelmees</td>
<td align="right">2</td>
<td align="right">246692</td>
<td align="right">523139</td>
</tr>
</tbody>
</table>
</div>
<p>As we’re not interested in all the data here, we will load a subset of the columns, specifically all unique combinations of routes and points, which will yield the corresponding <code>xcoor</code> and <code>ycoor</code> coordinates for each <code>count_point</code> within a <code>route</code>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">ptt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(route, count_point, xcoor, ycoor) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(route, count_point) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>) -&gt;<span class="st"> </span>ptt</a>
<a class="sourceLine" id="cb89-5" data-line-number="5"><span class="kw">head</span>(ptt, <span class="dv">10</span>)</a></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">route</th>
<th align="right">count_point</th>
<th align="right">xcoor</th>
<th align="right">ycoor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">246342</td>
<td align="right">520763</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">246357</td>
<td align="right">522178</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">3</td>
<td align="right">246692</td>
<td align="right">523139</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4</td>
<td align="right">248122</td>
<td align="right">522563</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">5</td>
<td align="right">248249</td>
<td align="right">521818</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">248649</td>
<td align="right">523073</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">7</td>
<td align="right">249142</td>
<td align="right">523614</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">250073</td>
<td align="right">523534</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">9</td>
<td align="right">252142</td>
<td align="right">523524</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
<td align="right">253056</td>
<td align="right">523458</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="calculate-interpoint-distances" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Calculate interpoint distances</h3>
<p>For each of the routes within the PTT dataset, we will calculate the average distance between the subsequent points, to buffer our convex hull by this value.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">ptt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(route) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">xcoor2 =</span> <span class="kw">c</span>(xcoor[<span class="op">-</span><span class="dv">1</span>], <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb90-4" data-line-number="4">         <span class="dt">ycoor2 =</span> <span class="kw">c</span>(ycoor[<span class="op">-</span><span class="dv">1</span>], <span class="dv">0</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-5" data-line-number="5"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">interpoint_distance =</span> <span class="kw">pointDistance</span>(<span class="kw">cbind</span>(xcoor, ycoor), <span class="kw">cbind</span>(xcoor2, ycoor2), <span class="dt">lonlat =</span> <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-8" data-line-number="8"><span class="st">  </span><span class="kw">filter</span>(xcoor2 <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Throw out last point from route where distance to next point is not relevant</span></a>
<a class="sourceLine" id="cb90-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(route) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-10" data-line-number="10"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_interpoint_distance =</span> <span class="kw">mean</span>(interpoint_distance), <span class="dt">.groups =</span> <span class="st">&quot;keep&quot;</span>) -&gt;<span class="st"> </span>ptt_interpoint_distances</a>
<a class="sourceLine" id="cb90-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb90-12" data-line-number="12">ptt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb90-13" data-line-number="13"><span class="st">  </span><span class="kw">left_join</span>(ptt_interpoint_distances, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;route&quot;</span> =<span class="st"> &quot;route&quot;</span>)) -&gt;<span class="st"> </span>ptt</a>
<a class="sourceLine" id="cb90-14" data-line-number="14"></a>
<a class="sourceLine" id="cb90-15" data-line-number="15"><span class="kw">head</span>(ptt, <span class="dv">10</span>)</a></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">route</th>
<th align="right">count_point</th>
<th align="right">xcoor</th>
<th align="right">ycoor</th>
<th align="right">avg_interpoint_distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">246342</td>
<td align="right">520763</td>
<td align="right">1162.042</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">246357</td>
<td align="right">522178</td>
<td align="right">1162.042</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">3</td>
<td align="right">246692</td>
<td align="right">523139</td>
<td align="right">1162.042</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4</td>
<td align="right">248122</td>
<td align="right">522563</td>
<td align="right">1162.042</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">5</td>
<td align="right">248249</td>
<td align="right">521818</td>
<td align="right">1162.042</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">248649</td>
<td align="right">523073</td>
<td align="right">1162.042</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">7</td>
<td align="right">249142</td>
<td align="right">523614</td>
<td align="right">1162.042</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">250073</td>
<td align="right">523534</td>
<td align="right">1162.042</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">9</td>
<td align="right">252142</td>
<td align="right">523524</td>
<td align="right">1162.042</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
<td align="right">253056</td>
<td align="right">523458</td>
<td align="right">1162.042</td>
</tr>
</tbody>
</table>
</div>
<p>We can now calculate the convex hulls of the points grouped by <code>route</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">ptt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;xcoor&quot;</span>, <span class="st">&quot;ycoor&quot;</span>), <span class="dt">crs =</span> <span class="dv">28992</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># original CRS = EPSG:28992 (RD New)</span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> ppi_hrw<span class="op">$</span>data<span class="op">@</span>proj4string) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(route, avg_interpoint_distance) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-6" data-line-number="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-7" data-line-number="7"><span class="st">  </span><span class="kw">st_convex_hull</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-8" data-line-number="8"><span class="st">  </span><span class="kw">st_as_sf</span>() -&gt;<span class="st"> </span>ptt_convex_hulls_hrw  <span class="co"># Somehow it&#39;s necessary to reconvert to sf?</span></a>
<a class="sourceLine" id="cb91-9" data-line-number="9"></a>
<a class="sourceLine" id="cb91-10" data-line-number="10">ptt <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-11" data-line-number="11"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-12" data-line-number="12"><span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;xcoor&quot;</span>, <span class="st">&quot;ycoor&quot;</span>), <span class="dt">crs =</span> <span class="dv">28992</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-13" data-line-number="13"><span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> ppi_dhl<span class="op">$</span>data<span class="op">@</span>proj4string) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-14" data-line-number="14"><span class="st">  </span><span class="kw">group_by</span>(route, avg_interpoint_distance) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-15" data-line-number="15"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-16" data-line-number="16"><span class="st">  </span><span class="kw">st_convex_hull</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-17" data-line-number="17"><span class="st">  </span><span class="kw">st_as_sf</span>() -&gt;<span class="st"> </span>ptt_convex_hulls_dhl</a>
<a class="sourceLine" id="cb91-18" data-line-number="18"></a>
<a class="sourceLine" id="cb91-19" data-line-number="19"><span class="kw">plot</span>(ptt_convex_hulls_hrw[<span class="dv">1</span>], <span class="dt">main =</span> <span class="st">&quot;PTT Routes Herwijnen: Route&quot;</span>)</a>
<a class="sourceLine" id="cb91-20" data-line-number="20"><span class="kw">plot</span>(ptt_convex_hulls_hrw[<span class="dv">2</span>], <span class="dt">main =</span> <span class="st">&quot;PTT Routes Herwijnen: Avg interpoint dist.&quot;</span>)</a>
<a class="sourceLine" id="cb91-21" data-line-number="21"><span class="kw">plot</span>(ptt_convex_hulls_dhl[<span class="dv">1</span>], <span class="dt">main =</span> <span class="st">&quot;PTT Routes Den Helder: Route&quot;</span>)</a>
<a class="sourceLine" id="cb91-22" data-line-number="22"><span class="kw">plot</span>(ptt_convex_hulls_dhl[<span class="dv">2</span>], <span class="dt">main =</span> <span class="st">&quot;PTT Routes Den Helder: Avg interpoint dist.&quot;</span>)</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/calculate_route_convex_hulls-1.png" width="672" /><img src="Fireworks_files/figure-html/calculate_route_convex_hulls-2.png" width="672" /><img src="Fireworks_files/figure-html/calculate_route_convex_hulls-3.png" width="672" /><img src="Fireworks_files/figure-html/calculate_route_convex_hulls-4.png" width="672" /></p>
<p>As we have calculated the average distance between the points, we can now buffer the convex hulls by this value to attain more representative sizes of the covered areas.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1">ptt_convex_hulls_hrw <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="st">  </span><span class="kw">st_buffer</span>(<span class="dt">dist =</span> <span class="kw">as.double</span>(ptt_convex_hulls_hrw<span class="op">$</span>avg_interpoint_distance)) -&gt;<span class="st"> </span>ptt_convex_hulls_hrw</a>
<a class="sourceLine" id="cb92-3" data-line-number="3"></a>
<a class="sourceLine" id="cb92-4" data-line-number="4">ptt_convex_hulls_dhl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-5" data-line-number="5"><span class="st">  </span><span class="kw">st_buffer</span>(<span class="dt">dist =</span> <span class="kw">as.double</span>(ptt_convex_hulls_dhl<span class="op">$</span>avg_interpoint_distance)) -&gt;<span class="st"> </span>ptt_convex_hulls_dhl</a>
<a class="sourceLine" id="cb92-6" data-line-number="6"></a>
<a class="sourceLine" id="cb92-7" data-line-number="7"><span class="kw">st_write</span>(ptt_convex_hulls_hrw, <span class="st">&quot;data/processed/sovon/ptt_convex_hulls_hrw.shp&quot;</span>, <span class="dt">delete_dsn =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in abbreviate_shapefile_names(obj): Field names abbreviated for ESRI Shapefile driver</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="kw">st_write</span>(ptt_convex_hulls_dhl, <span class="st">&quot;data/processed/sovon/ptt_convex_hulls_dhl.shp&quot;</span>, <span class="dt">delete_dsn =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in abbreviate_shapefile_names(obj): Field names abbreviated for ESRI Shapefile driver</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="kw">plot</span>(ptt_convex_hulls_hrw[<span class="dv">1</span>], <span class="dt">main =</span> <span class="st">&quot;Buffered PTT Routes Herwijnen&quot;</span>)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2"><span class="kw">plot</span>(ptt_convex_hulls_dhl[<span class="dv">1</span>], <span class="dt">main =</span> <span class="st">&quot;Buffered PTT Routes Den Helder&quot;</span>)</a></code></pre></div>
<pre><code>## Deleting source `data/processed/sovon/ptt_convex_hulls_hrw.shp&#39; using driver `ESRI Shapefile&#39;
## Writing layer `ptt_convex_hulls_hrw&#39; to data source `data/processed/sovon/ptt_convex_hulls_hrw.shp&#39; using driver `ESRI Shapefile&#39;
## Writing 591 features with 2 fields and geometry type Polygon.
## Deleting source `data/processed/sovon/ptt_convex_hulls_dhl.shp&#39; using driver `ESRI Shapefile&#39;
## Writing layer `ptt_convex_hulls_dhl&#39; to data source `data/processed/sovon/ptt_convex_hulls_dhl.shp&#39; using driver `ESRI Shapefile&#39;
## Writing 591 features with 2 fields and geometry type Polygon.</code></pre>
<p><img src="Fireworks_files/figure-html/buffer_convex_hulls_with_interpoint_distance-1.png" width="672" /><img src="Fireworks_files/figure-html/buffer_convex_hulls_with_interpoint_distance-2.png" width="672" /></p>
<p>Now that is taken care of, we can rasterize the polygons using the <code>fasterize</code> package. As there is overlap between the areas covered by the routes using the convex hulls and a raster can only contain a single value for every pixel, we need to resolve this overlap. In this case we will compare overlapping areas and pick those where the average distance between the points for that area is lowest. This biases towards counts that cover a smaller area, so probably resulting in more accurate estimates of birds around.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">ptt_hrw &lt;-<span class="st"> </span><span class="kw">raster</span>(ppi_hrw<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb98-2" data-line-number="2">ptt_dhl &lt;-<span class="st"> </span><span class="kw">raster</span>(ppi_dhl<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb98-3" data-line-number="3"></a>
<a class="sourceLine" id="cb98-4" data-line-number="4">ptt_hrw &lt;-<span class="st"> </span><span class="kw">fasterize</span>(ptt_convex_hulls_hrw, ptt_hrw, <span class="dt">field =</span> <span class="st">&quot;route&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;avg_interpoint_distance&quot;</span>)</a>
<a class="sourceLine" id="cb98-5" data-line-number="5">ptt_dhl &lt;-<span class="st"> </span><span class="kw">fasterize</span>(ptt_convex_hulls_dhl, ptt_dhl, <span class="dt">field =</span> <span class="st">&quot;route&quot;</span>, <span class="dt">by =</span> <span class="st">&quot;avg_interpoint_distance&quot;</span>)</a>
<a class="sourceLine" id="cb98-6" data-line-number="6"></a>
<a class="sourceLine" id="cb98-7" data-line-number="7">ptt_hrw &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">stackApply</span>(ptt_hrw, <span class="dt">indices =</span> <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(ptt_hrw)), <span class="dt">fun =</span> min, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb98-8" data-line-number="8">ptt_dhl &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">stackApply</span>(ptt_dhl, <span class="dt">indices =</span> <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">length</span>(ptt_dhl)), <span class="dt">fun =</span> min, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb98-9" data-line-number="9"></a>
<a class="sourceLine" id="cb98-10" data-line-number="10"><span class="kw">plot</span>(ptt_hrw, <span class="dt">main =</span> <span class="st">&quot;Rasterized PTT routes Herwijnen&quot;</span>)</a>
<a class="sourceLine" id="cb98-11" data-line-number="11"><span class="kw">plot</span>(ptt_dhl, <span class="dt">main =</span> <span class="st">&quot;Rasterized PTT routes Den Helder&quot;</span>)</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/rasterize_convex_hulls-1.png" width="672" /><img src="Fireworks_files/figure-html/rasterize_convex_hulls-2.png" width="672" /></p>
<p>With the rasterization done, let’s compare the resultant raster and see if it is identical to the PPIs.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1"><span class="kw">compareRaster</span>(<span class="kw">as</span>(ptt_hrw, <span class="st">&quot;Raster&quot;</span>), <span class="kw">as</span>(ppi_hrw<span class="op">$</span>data, <span class="st">&quot;RasterLayer&quot;</span>), <span class="dt">extent =</span> <span class="ot">TRUE</span>, <span class="dt">rowcol =</span> <span class="ot">TRUE</span>, <span class="dt">crs =</span> <span class="ot">TRUE</span>, <span class="dt">res =</span> <span class="ot">TRUE</span>, <span class="dt">orig =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="kw">compareRaster</span>(<span class="kw">as</span>(ptt_dhl, <span class="st">&quot;Raster&quot;</span>), <span class="kw">as</span>(ppi_dhl<span class="op">$</span>data, <span class="st">&quot;RasterLayer&quot;</span>), <span class="dt">extent =</span> <span class="ot">TRUE</span>, <span class="dt">rowcol =</span> <span class="ot">TRUE</span>, <span class="dt">crs =</span> <span class="ot">TRUE</span>, <span class="dt">res =</span> <span class="ot">TRUE</span>, <span class="dt">orig =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] TRUE
## [1] TRUE</code></pre>
<p>Two TRUEs, so that’s excellent. We can now add the <code>ptt_route</code> to the PPIs.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">ppi_hrw<span class="op">$</span>data<span class="op">$</span>ptt_route &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">as.data.frame</span>(<span class="kw">as</span>(ptt_hrw, <span class="st">&quot;Raster&quot;</span>)))</a>
<a class="sourceLine" id="cb101-2" data-line-number="2">ppi_dhl<span class="op">$</span>data<span class="op">$</span>ptt_route &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">as.data.frame</span>(<span class="kw">as</span>(ptt_dhl, <span class="st">&quot;Raster&quot;</span>)))</a></code></pre></div>
<p>Let’s verify once again if that occurred as planned.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw">plot</span>(ppi_hrw, <span class="dt">param =</span> <span class="st">&quot;ptt_route&quot;</span>, <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(ppi_hrw<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>ptt_route, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="kw">max</span>(ppi_hrw<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>ptt_route, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="kw">plot</span>(ppi_dhl, <span class="dt">param =</span> <span class="st">&quot;ptt_route&quot;</span>, <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="kw">min</span>(ppi_dhl<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>ptt_route, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="kw">max</span>(ppi_dhl<span class="op">$</span>data<span class="op">@</span>data<span class="op">$</span>ptt_route, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/plot_ptt_ppis-1.png" width="672" /><img src="Fireworks_files/figure-html/plot_ptt_ppis-2.png" width="672" /></p>
<p>That seems fine, we can now save the PPIs, so we can start linking actual count data.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">saveRDS</span>(ppi_hrw, <span class="dt">file =</span> <span class="st">&quot;data/processed/corrected-ppis-lu-sovon/corrected_ppi_hrw_lu_sovon.RDS&quot;</span>)</a>
<a class="sourceLine" id="cb103-2" data-line-number="2"><span class="kw">saveRDS</span>(ppi_dhl, <span class="dt">file =</span> <span class="st">&quot;data/processed/corrected-ppis-lu-sovon/corrected_ppi_dhl_lu_sovon.RDS&quot;</span>)</a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="03.Annotate-land-use.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="05.Processing-count-results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/barthoekstra/fireworks/edit/master/04.Annotate-count-areas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/barthoekstra/fireworks/blob/master/04.Annotate-count-areas.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
