<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Selecting firework take-off moment | Fireworks</title>
  <meta name="description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Selecting firework take-off moment | Fireworks" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Selecting firework take-off moment | Fireworks" />
  
  <meta name="twitter:description" content="Using ground-based bird counts and weather radar measurements to estimate numbers of birds aloft during NYE fireworks events." />
  

<meta name="author" content="Bart Hoekstra" />


<meta name="date" content="2020-10-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="02.Radar-data-preprocessing.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="assets/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="assets/layer.1-1/data_stars_layer11403c5.txt"></script>
<script src="assets/joda-0.0.1/joda.js"></script>
<script src="assets/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/layer.2-1/data_stars_layer2ef1687.txt"></script>
<script src="assets/layer.3-1/data_stars_layer397ab21.txt"></script>
<script src="assets/layer.4-1/data_stars_layer4f39627.txt"></script>
<script src="assets/layer.5-1/data_stars_layer578154e.txt"></script>
<script src="assets/layer.6-1/data_stars_layer6f23d60.txt"></script>
<script src="assets/layer.7-1/data_stars_layer73ad4ce.txt"></script>
<script src="assets/layer.8-1/data_stars_layer85a6ec3.txt"></script>
<script src="assets/layer.9-1/data_stars_layer9fc9123.txt"></script>
<script src="assets/layer.10-1/data_stars_layer10e03bdc.txt"></script>
<script src="assets/urban-1/data_stars_urban1e075b.txt"></script>
<script src="assets/agricultural-1/data_stars_agriculturald521e8.txt"></script>
<script src="assets/semiopen-1/data_stars_semiopenf745b0.txt"></script>
<script src="assets/forests-1/data_stars_forests275461.txt"></script>
<script src="assets/wetlands-1/data_stars_wetlands62acf3.txt"></script>
<script src="assets/waterbodies-1/data_stars_waterbodiesca4782.txt"></script>
<script src="assets/dist_urban-1/data_stars_dist_urban570ad9.txt"></script>
<script src="assets/human_pop-1/data_stars_human_pop627d50.txt"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<script src="assets/resid-1/data_stars_stars62d918.txt"></script>
<link href="assets/jquery-ui-1.10.3/jquery-ui-1.10.3.custom.min.css" rel="stylesheet" />
<script src="assets/jquery-ui-1.10.3/jquery-ui-1.10.3.custom.min.js"></script>
<link href="assets/opacity-1.0.0/Control.Opacity.css" rel="stylesheet" />
<script src="assets/opacity-1.0.0/Control.Opacity.js"></script>
<script src="assets/local_sa-1/data_stars_local_saf48e6d.txt"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-this-document"><i class="fa fa-check"></i>How to use this document</a></li>
</ul></li>
<li class="part"><span><b>I Weather radar data</b></span></li>
<li class="chapter" data-level="1" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html"><i class="fa fa-check"></i><b>1</b> Selecting firework take-off moment</a><ul>
<li class="chapter" data-level="1.1" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#processing-environment"><i class="fa fa-check"></i><b>1.1</b> Processing environment</a></li>
<li class="chapter" data-level="1.2" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#calculate-the-vertical-profiles"><i class="fa fa-check"></i><b>1.2</b> Calculate the vertical profiles</a></li>
<li class="chapter" data-level="1.3" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#generate-time-series-of-vertical-profiles"><i class="fa fa-check"></i><b>1.3</b> Generate time series of vertical profiles</a></li>
<li class="chapter" data-level="1.4" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#identifying-moment-of-take-off"><i class="fa fa-check"></i><b>1.4</b> Identifying moment of take-off</a></li>
<li class="chapter" data-level="1.5" data-path="01.Selecting-take-off-moments.html"><a href="01.Selecting-take-off-moments.html#determining-maximum-range-from-radar-to-detect-birds"><i class="fa fa-check"></i><b>1.5</b> Determining maximum range from radar to detect birds</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html"><i class="fa fa-check"></i><b>2</b> Radar Data Preprocessing</a><ul>
<li class="chapter" data-level="2.1" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#processing-environment-1"><i class="fa fa-check"></i><b>2.1</b> Processing environment</a></li>
<li class="chapter" data-level="2.2" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#removing-electromagnetic-interference"><i class="fa fa-check"></i><b>2.2</b> Removing electromagnetic interference</a></li>
<li class="chapter" data-level="2.3" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#filter-meteorology-using-the-depolarization-ratio"><i class="fa fa-check"></i><b>2.3</b> Filter meteorology using the depolarization ratio</a></li>
<li class="chapter" data-level="2.4" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#remove-classified-precipitation-from-polar-volumes"><i class="fa fa-check"></i><b>2.4</b> Remove classified precipitation from polar volumes</a></li>
<li class="chapter" data-level="2.5" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#filter-ground-clutter"><i class="fa fa-check"></i><b>2.5</b> Filter ground clutter</a></li>
<li class="chapter" data-level="2.6" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#range-bias-correction"><i class="fa fa-check"></i><b>2.6</b> Range-bias correction</a></li>
<li class="chapter" data-level="2.7" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#keep-biologymeteorology-classification"><i class="fa fa-check"></i><b>2.7</b> Keep biology/meteorology classification</a></li>
<li class="chapter" data-level="2.8" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#distance-to-radar"><i class="fa fa-check"></i><b>2.8</b> Distance to radar</a></li>
<li class="chapter" data-level="2.9" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#spatial-coordinates"><i class="fa fa-check"></i><b>2.9</b> Spatial coordinates</a></li>
<li class="chapter" data-level="2.10" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#visualising-range-bias-correction"><i class="fa fa-check"></i><b>2.10</b> Visualising range-bias correction</a></li>
<li class="chapter" data-level="2.11" data-path="02.Radar-data-preprocessing.html"><a href="02.Radar-data-preprocessing.html#preprocess-additional-scans"><i class="fa fa-check"></i><b>2.11</b> Preprocess additional scans</a></li>
</ul></li>
<li class="part"><span><b>II Land use</b></span></li>
<li class="chapter" data-level="3" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html"><i class="fa fa-check"></i><b>3</b> Annotating land use</a><ul>
<li class="chapter" data-level="3.1" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#processing-environment-2"><i class="fa fa-check"></i><b>3.1</b> Processing environment</a></li>
<li class="chapter" data-level="3.2" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#converting-the-land-use-map"><i class="fa fa-check"></i><b>3.2</b> Converting the land use map</a></li>
<li class="chapter" data-level="3.3" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#adding-land-use-classifications-to-the-ppis"><i class="fa fa-check"></i><b>3.3</b> Adding land use classifications to the PPIs</a></li>
<li class="chapter" data-level="3.4" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#calculate-distance-to-nearest-urban-area"><i class="fa fa-check"></i><b>3.4</b> Calculate distance to nearest urban area</a></li>
<li class="chapter" data-level="3.5" data-path="03.Annotate-land-use.html"><a href="03.Annotate-land-use.html#add-population-density"><i class="fa fa-check"></i><b>3.5</b> Add population density</a></li>
</ul></li>
<li class="part"><span><b>III Sovon counts</b></span></li>
<li class="chapter" data-level="4" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html"><i class="fa fa-check"></i><b>4</b> Annotating count areas</a><ul>
<li class="chapter" data-level="4.1" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#processing-environment-3"><i class="fa fa-check"></i><b>4.1</b> Processing environment</a></li>
<li class="chapter" data-level="4.2" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#annotate-ppis-with-waterbird-area-codes"><i class="fa fa-check"></i><b>4.2</b> Annotate PPIs with waterbird area codes</a></li>
<li class="chapter" data-level="4.3" data-path="04.Annotate-count-areas.html"><a href="04.Annotate-count-areas.html#annotate-ppis-with-point-transect-counts"><i class="fa fa-check"></i><b>4.3</b> Annotate PPIs with point-transect-counts</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html"><i class="fa fa-check"></i><b>5</b> Processing count results</a><ul>
<li class="chapter" data-level="5.1" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#processing-environment-4"><i class="fa fa-check"></i><b>5.1</b> Processing environment</a></li>
<li class="chapter" data-level="5.2" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#loading-the-sovon-count-data"><i class="fa fa-check"></i><b>5.2</b> Loading the Sovon count data</a></li>
<li class="chapter" data-level="5.3" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#filteringpreprocessing-species-names"><i class="fa fa-check"></i><b>5.3</b> Filtering/preprocessing species names</a></li>
<li class="chapter" data-level="5.4" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#adding-vernacular-family-names"><i class="fa fa-check"></i><b>5.4</b> Adding vernacular family names</a></li>
<li class="chapter" data-level="5.5" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#linking-life-history-traits-to-species"><i class="fa fa-check"></i><b>5.5</b> Linking life-history traits to species</a></li>
<li class="chapter" data-level="5.6" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#calculating-total-bird-biomass"><i class="fa fa-check"></i><b>5.6</b> Calculating total bird biomass</a></li>
<li class="chapter" data-level="5.7" data-path="05.Processing-count-results.html"><a href="05.Processing-count-results.html#calculating-proportions-across-bird-families"><i class="fa fa-check"></i><b>5.7</b> Calculating proportions across bird families</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html"><i class="fa fa-check"></i><b>6</b> Apply processing to all PPIs</a><ul>
<li class="chapter" data-level="6.1" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#processing-environment-5"><i class="fa fa-check"></i><b>6.1</b> Processing environment</a></li>
<li class="chapter" data-level="6.2" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#load-the-reference-ppis"><i class="fa fa-check"></i><b>6.2</b> Load the reference PPIs</a></li>
<li class="chapter" data-level="6.3" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#add-biomass-to-reference-ppis"><i class="fa fa-check"></i><b>6.3</b> Add biomass to reference PPIs</a></li>
<li class="chapter" data-level="6.4" data-path="06.Applying-annotations-to-all-PPIs.html"><a href="06.Applying-annotations-to-all-PPIs.html#copy-annotations-from-reference-ppis-to-other-ppis"><i class="fa fa-check"></i><b>6.4</b> Copy annotations from reference PPIs to other PPIs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html"><i class="fa fa-check"></i><b>7</b> Composite all PPIs</a><ul>
<li class="chapter" data-level="7.1" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#processing-environment-6"><i class="fa fa-check"></i><b>7.1</b> Processing environment</a></li>
<li class="chapter" data-level="7.2" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#generating-the-composite-ppis"><i class="fa fa-check"></i><b>7.2</b> Generating the composite PPIs</a></li>
<li class="chapter" data-level="7.3" data-path="07.Composite-all-PPIs.html"><a href="07.Composite-all-PPIs.html#visualising-the-composites"><i class="fa fa-check"></i><b>7.3</b> Visualising the composites</a></li>
</ul></li>
<li class="part"><span><b>IV Fireworks disturbance</b></span></li>
<li class="chapter" data-level="8" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html"><i class="fa fa-check"></i><b>8</b> Modelling fireworks disturbance</a><ul>
<li class="chapter" data-level="8.1" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#processing-environment-7"><i class="fa fa-check"></i><b>8.1</b> Processing environment</a></li>
<li class="chapter" data-level="8.2" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#preparing-a-dataset-for-modelling"><i class="fa fa-check"></i><b>8.2</b> Preparing a dataset for modelling</a></li>
<li class="chapter" data-level="8.3" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#determine-model-resolution-based-on-performance-in-simple-total_biomass-model"><i class="fa fa-check"></i><b>8.3</b> Determine model resolution based on performance in simple <code>total_biomass</code> model</a></li>
<li class="chapter" data-level="8.4" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#check-for-correlations-among-predictors"><i class="fa fa-check"></i><b>8.4</b> Check for correlations among predictors</a></li>
<li class="chapter" data-level="8.5" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#correlated-land-use-proportions"><i class="fa fa-check"></i><b>8.5</b> Correlated land use proportions</a></li>
<li class="chapter" data-level="8.6" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#determine-the-most-suitable-proxy-for-disturbance"><i class="fa fa-check"></i><b>8.6</b> Determine the most suitable proxy for disturbance</a></li>
<li class="chapter" data-level="8.7" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#determine-the-optimal-number-of-boosting-steps"><i class="fa fa-check"></i><b>8.7</b> Determine the optimal number of boosting steps</a></li>
<li class="chapter" data-level="8.8" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#variable-importance"><i class="fa fa-check"></i><b>8.8</b> Variable importance</a></li>
<li class="chapter" data-level="8.9" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#model-marginal-effects"><i class="fa fa-check"></i><b>8.9</b> Model marginal effects</a></li>
<li class="chapter" data-level="8.10" data-path="08.Model-fireworks-disturbance.html"><a href="08.Model-fireworks-disturbance.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>8.10</b> Spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html"><i class="fa fa-check"></i><b>9</b> Quantifying model uncertainty</a><ul>
<li class="chapter" data-level="9.1" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#processing-environment-8"><i class="fa fa-check"></i><b>9.1</b> Processing environment</a></li>
<li class="chapter" data-level="9.2" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#load-the-constructed-model"><i class="fa fa-check"></i><b>9.2</b> Load the constructed model</a></li>
<li class="chapter" data-level="9.3" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#bootstrapped-uncertainty-analysis"><i class="fa fa-check"></i><b>9.3</b> Bootstrapped uncertainty analysis</a></li>
<li class="chapter" data-level="9.4" data-path="09.Quantifying-model-uncertainty.html"><a href="09.Quantifying-model-uncertainty.html#recombine-bootstrapped-results"><i class="fa fa-check"></i><b>9.4</b> Recombine bootstrapped results</a></li>
</ul></li>
<li class="part"><span><b>V Figures</b></span></li>
<li class="chapter" data-level="10" data-path="10.Figures-1-Data-overview.html"><a href="10.Figures-1-Data-overview.html"><i class="fa fa-check"></i><b>10</b> Figure 1: Data overview</a><ul>
<li class="chapter" data-level="10.1" data-path="10.Figures-1-Data-overview.html"><a href="10.Figures-1-Data-overview.html#processing-environment-9"><i class="fa fa-check"></i><b>10.1</b> Processing environment</a></li>
<li class="chapter" data-level="10.2" data-path="10.Figures-1-Data-overview.html"><a href="10.Figures-1-Data-overview.html#workflow"><i class="fa fa-check"></i><b>10.2</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html"><i class="fa fa-check"></i><b>11</b> Figure 2: Model output</a><ul>
<li class="chapter" data-level="11.1" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#processing-environment-10"><i class="fa fa-check"></i><b>11.1</b> Processing environment</a></li>
<li class="chapter" data-level="11.2" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#variable-importance-1"><i class="fa fa-check"></i><b>11.2</b> Variable importance</a></li>
<li class="chapter" data-level="11.3" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#compare-groups"><i class="fa fa-check"></i><b>11.3</b> Compare groups</a></li>
<li class="chapter" data-level="11.4" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#visualise-marginal-effects"><i class="fa fa-check"></i><b>11.4</b> Visualise marginal effects</a></li>
<li class="chapter" data-level="11.5" data-path="10.Figures-2-Model.html"><a href="10.Figures-2-Model.html#all-marginal-effects"><i class="fa fa-check"></i><b>11.5</b> All marginal effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html"><i class="fa fa-check"></i><b>12</b> Figure 3: Species composition</a><ul>
<li class="chapter" data-level="12.1" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html#processing-environment-11"><i class="fa fa-check"></i><b>12.1</b> Processing environment</a></li>
<li class="chapter" data-level="12.2" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html#characteristic-families"><i class="fa fa-check"></i><b>12.2</b> Characteristic families</a></li>
<li class="chapter" data-level="12.3" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html#mean-habitat-biomass-and-weight"><i class="fa fa-check"></i><b>12.3</b> Mean habitat biomass and weight</a></li>
<li class="chapter" data-level="12.4" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html#sorting-of-families-by-weight"><i class="fa fa-check"></i><b>12.4</b> Sorting of families by weight</a></li>
<li class="chapter" data-level="12.5" data-path="10.Figures-3-Species-composition.html"><a href="10.Figures-3-Species-composition.html#prepare-plot"><i class="fa fa-check"></i><b>12.5</b> Prepare plot</a></li>
</ul></li>
<li class="part"><span><b>VI Appendix</b></span></li>
<li class="chapter" data-level="13" data-path="A1.Generating-VPs-for-Den-Helder-radar.html"><a href="A1.Generating-VPs-for-Den-Helder-radar.html"><i class="fa fa-check"></i><b>13</b> Generating vertical profiles for Den Helder radar</a></li>
<li class="part"><span><b>VII Other</b></span></li>
<li class="chapter" data-level="14" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fireworks</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="selecting-firework-take-off-moment" class="section level1">
<h1><span class="header-section-number">1</span> Selecting firework take-off moment</h1>
<p>For this study we select the moment of ‘en masse’ take-off of birds at the turn of the year. To make sure birds are still fairly ‘close’ to the take-off habitat, we therefore focus on the period where the increase in <code>VIR</code> (Vertically Integrated Reflectivity) is the highest. Based on experience, one would expect this to occur between 00:05 and 00:15 on January 1st, as people tend to light the fireworks right after they have shared New Year’s wishes with each other.</p>
<div id="processing-environment" class="section level2">
<h2><span class="header-section-number">1.1</span> Processing environment</h2>
<p>We use <code>vol2bird</code> included in the <a href="http://adokter.github.io/bioRad">bioRad package</a> <span class="citation">(Dokter et al. <a href="#ref-dokter_biorad_2019">2019</a>)</span> to calculate the vertical profiles of reflectivity, from which we determine the exact take off moment of birds. This implies we assume birds take to the skies everywhere simultaneously, but that seems a realistic assumption given that the lighting of fireworks is synchronised by the national time, rather than the local time of sunset/sunrise.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(bioRad)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">Sys.setenv</span>(<span class="dt">TZ =</span> <span class="st">&quot;UTC&quot;</span>)</a></code></pre></div>
</div>
<div id="calculate-the-vertical-profiles" class="section level2">
<h2><span class="header-section-number">1.2</span> Calculate the vertical profiles</h2>
<p>We calculate vertical profiles for the period between December 31st, 2017 22:00 and 01:00 UTC on January 1st, 2018, which corresponds with 23:00 til 02:00 local Amsterdam time (UTC + 1). It is not necessary to generate so many <code>vp</code> files, but it gives a better temporal overview of the event if we add some ‘temporal padding’ around the fireworks event.</p>
<p><em>Beware: to calculate the vertical profiles, a running instance of <a href="https://www.docker.com">Docker</a> is required. This code chunk will only run in full-reproduction mode.</em></p>
<p>See the appendix on [generating VPs for Den Helder][generating-vps-for-den-helder-radar] for a more detailed explanation why we limit <code>vp</code> generation of Den Helder to certain azimuths.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">fireworks_scans &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="kw">file.path</span>(<span class="st">&quot;data/raw/pvol/fireworks-2017-2018&quot;</span>, <span class="st">&quot;*_ODIM.h5&quot;</span>))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">cat</span>(<span class="st">&quot;Files left to process: &quot;</span>, <span class="kw">length</span>(fireworks_scans), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="cf">for</span> (scan <span class="cf">in</span> fireworks_scans) {</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="cf">if</span> (i <span class="op">%%</span><span class="st"> </span><span class="dv">5</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    <span class="kw">cat</span>(i, <span class="st">&quot;... &quot;</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  }</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  vpfile_out &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;raw/pvol/fireworks-2017-2018&quot;</span>, <span class="st">&quot;processed/vp/fireworks-2017-2018&quot;</span>, scan)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">  <span class="cf">if</span> (<span class="kw">grepl</span>(<span class="st">&quot;RAD_NL61&quot;</span>, vpfile_out)) {</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    <span class="kw">try</span>(<span class="kw">calculate_vp</span>(scan, <span class="dt">vpfile =</span> vpfile_out, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">mount =</span> <span class="kw">dirname</span>(fireworks_scans[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">                     <span class="dt">azim_min =</span> <span class="dv">90</span>, <span class="dt">azim_max =</span> <span class="dv">200</span>, <span class="dt">h_layer =</span> <span class="dv">50</span>, <span class="dt">n_layer =</span> <span class="dv">80</span>))</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">    <span class="kw">try</span>(<span class="kw">calculate_vp</span>(scan, <span class="dt">vpfile =</span> vpfile_out, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">mount =</span> <span class="kw">dirname</span>(fireworks_scans[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                     <span class="dt">h_layer =</span> <span class="dv">50</span>, <span class="dt">n_layer =</span> <span class="dv">80</span>))</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  }</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18">}</a></code></pre></div>
</div>
<div id="generate-time-series-of-vertical-profiles" class="section level2">
<h2><span class="header-section-number">1.3</span> Generate time series of vertical profiles</h2>
<p>We can now generate a time series of vertical profiles (a VPTS) and plot the bird densities to get an idea of what was going on during NYE of 2017-2018.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fw_hrw_vpts &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="kw">file.path</span>(<span class="st">&quot;data/processed/vp/fireworks-2017-2018&quot;</span>, <span class="st">&quot;*NL62*&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">read_vpfiles</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">bind_into_vpts</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw">regularize_vpts</span>(<span class="dt">interval =</span> <span class="st">&quot;auto&quot;</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">fw_dhl_vpts &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="kw">file.path</span>(<span class="st">&quot;data/processed/vp/fireworks-2017-2018&quot;</span>, <span class="st">&quot;*NL61*&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw">read_vpfiles</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw">bind_into_vpts</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw">regularize_vpts</span>(<span class="dt">interval =</span> <span class="st">&quot;auto&quot;</span>)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">start &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2017-12-31 22:00:00&quot;</span>)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">end &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2018-01-01 01:00:00&quot;</span>)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">indexes_hrw &lt;-<span class="st"> </span><span class="kw">which</span>(fw_hrw_vpts<span class="op">$</span>datetime <span class="op">&gt;=</span><span class="st"> </span>start <span class="op">&amp;</span><span class="st"> </span>fw_hrw_vpts<span class="op">$</span>datetime <span class="op">&lt;=</span><span class="st"> </span>end)</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">indexes_dhl &lt;-<span class="st"> </span><span class="kw">which</span>(fw_dhl_vpts<span class="op">$</span>datetime <span class="op">&gt;=</span><span class="st"> </span>start <span class="op">&amp;</span><span class="st"> </span>fw_dhl_vpts<span class="op">$</span>datetime <span class="op">&lt;=</span><span class="st"> </span>end) <span class="co"># Should mostly be identical</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">title_hrw &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Herwijnen: volume density [#/km&quot;</span><span class="op">^</span><span class="dv">3</span> <span class="op">*</span><span class="st"> &quot;]&quot;</span>)</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">title_dhl &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Den Helder: volume density [#/km&quot;</span><span class="op">^</span><span class="dv">3</span> <span class="op">*</span><span class="st"> &quot;]&quot;</span>)</a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="kw">plot</span>(fw_hrw_vpts[indexes_hrw], <span class="dt">main =</span> title_hrw)</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/generate_vp_timeseries-1.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">plot</span>(fw_dhl_vpts[indexes_dhl], <span class="dt">main =</span> title_dhl)</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/generate_vp_timeseries-2.png" width="672" /></p>
<pre><code>## projecting on 300 seconds interval grid...
## projecting on 300 seconds interval grid...</code></pre>
<p>Both plots for Herwijnen and Den Helder show exactly what we would expect: comparatively low densities of birds aloft leading up to midnight (23:00 CET), then suddenly a strong increase of birds right after midnight. For Den Helder this peak appears much more pronounced, whereas for Herwijnen the period of disturbance seems to take considerably longer. This is probably due to the vastly different environment around the radar site: Herwijnen is located solidly in the center of the country, whereas Den Helder is located close to the coast on a ‘peninsula’ with much less land in the surroundings, pronounced by <code>vol2bird</code> only taking the rangegates within 5-35km of the radar into account.</p>
</div>
<div id="identifying-moment-of-take-off" class="section level2">
<h2><span class="header-section-number">1.4</span> Identifying moment of take-off</h2>
<p>We integrate the time series of vertical profiles, so we can calculate the <code>VIR</code> derivatives and determine in what volume scan birds really take to the skies for each radar separately.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">integrated_hrw &lt;-<span class="st"> </span><span class="kw">integrate_profile</span>(fw_hrw_vpts)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">integrated_dhl &lt;-<span class="st"> </span><span class="kw">integrate_profile</span>(fw_dhl_vpts)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">integrated_hrw<span class="op">$</span>vir_deriv &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(integrated_hrw<span class="op">$</span>vir, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">integrated_dhl<span class="op">$</span>vir_deriv &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, <span class="kw">diff</span>(integrated_dhl<span class="op">$</span>vir, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">integrated_hrw<span class="op">$</span>radar &lt;-<span class="st"> &quot;Herwijnen&quot;</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">integrated_dhl<span class="op">$</span>radar &lt;-<span class="st"> &quot;Den Helder&quot;</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">integrated &lt;-<span class="st"> </span><span class="kw">rbind</span>(integrated_hrw, integrated_dhl)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">integrated_l &lt;-<span class="st"> </span>integrated <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;datetime&quot;</span>, <span class="st">&quot;radar&quot;</span>), <span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;vir&quot;</span> <span class="op">|</span><span class="st"> </span>variable <span class="op">==</span><span class="st"> &quot;vir_deriv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw">filter</span>(datetime <span class="op">&gt;=</span><span class="st"> </span>start <span class="op">&amp;</span><span class="st"> </span>datetime <span class="op">&lt;=</span><span class="st"> </span>end)</a>
<a class="sourceLine" id="cb7-16" data-line-number="16"></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">max_vir_deriv &lt;-<span class="st"> </span>integrated_l <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="st">  </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;vir_deriv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="st">  </span><span class="kw">group_by</span>(radar) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">max_value =</span> <span class="kw">max</span>(value), <span class="dt">datetime =</span> datetime[<span class="kw">which.max</span>(value)], <span class="dt">.groups =</span> <span class="st">&quot;drop_last&quot;</span>)</a>
<a class="sourceLine" id="cb7-22" data-line-number="22"></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="kw">ggplot</span>(integrated_l, <span class="kw">aes</span>(<span class="dt">x =</span> datetime)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> value, <span class="dt">colour =</span> radar, <span class="dt">linetype =</span> variable)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">breaks =</span> <span class="st">&quot;10 min&quot;</span>, <span class="dt">date_labels =</span> <span class="st">&quot;%H:%M&quot;</span>, <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_linetype_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Line type&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;VIR&quot;</span>, <span class="kw">expression</span>(<span class="kw">paste</span>(Delta,<span class="st">&quot;VIR/scan&quot;</span>)))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Time series of Vertically Integrated Reflectivities (VIR)&quot;</span>,</a>
<a class="sourceLine" id="cb7-30" data-line-number="30">       <span class="dt">subtitle =</span> <span class="st">&quot;NYE 2017-2018&quot;</span>,</a>
<a class="sourceLine" id="cb7-31" data-line-number="31">       <span class="dt">x =</span> <span class="st">&quot;Time (CET)&quot;</span>,</a>
<a class="sourceLine" id="cb7-32" data-line-number="32">       <span class="dt">y =</span> <span class="st">&quot;VIR&quot;</span>,</a>
<a class="sourceLine" id="cb7-33" data-line-number="33">       <span class="dt">colour =</span> <span class="st">&quot;Radar&quot;</span>,</a>
<a class="sourceLine" id="cb7-34" data-line-number="34">       <span class="dt">linetype =</span> <span class="st">&quot;Linetype&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">-90</span>),</a>
<a class="sourceLine" id="cb7-36" data-line-number="36">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/identify_takeoff-1.png" width="672" /></p>
<p>The plot shows a rapid increase in <code>VIR</code> in the first 15 and 20 minutes after midnight (23:00 CET) for the Den Helder and Herwijnen radar respectively. After that period, <code>VIR</code> starts to drop, faster for Den Helder than for Herwijnen, possibly as a result of birds dispersing from the North Holland mainland towards the IJsselmeer area, which we have deliberately excluded from the generation of the vertical profiles (by selecting azimuths that are above land).</p>
<p>To reduce the effect of bird dispersal on our analysis, we will focus only on the first 5 minute-scan during which <code>VIR</code> grows rapidly. That is from 23:05 CET until 23:10 CET.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">pvol_folder &lt;-<span class="st"> &quot;data/raw/pvol/fireworks-2017-2018/&quot;</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">scan_timestamp &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">ymd_hm</span>(<span class="st">&quot;2017-12-31 23:05&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">pvol_hrw_path &lt;-<span class="st"> </span><span class="kw">paste</span>(pvol_folder, <span class="st">&quot;RAD_NL62_VOL_NA_&quot;</span>, <span class="kw">format</span>(scan_timestamp, <span class="st">&quot;%Y%m%d%H%M&quot;</span>), <span class="st">&quot;_ODIM.h5&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">pvol_dhl_path &lt;-<span class="st"> </span><span class="kw">paste</span>(pvol_folder, <span class="st">&quot;RAD_NL61_VOL_NA_&quot;</span>, <span class="kw">format</span>(scan_timestamp, <span class="st">&quot;%Y%m%d%H%M&quot;</span>), <span class="st">&quot;_ODIM.h5&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="kw">save</span>(pvol_hrw_path, pvol_dhl_path, <span class="dt">file =</span> <span class="st">&quot;data/processed/pvol_selection.RData&quot;</span>)</a></code></pre></div>
<p>So we will mainly focus on working with the following polar volume files:</p>
<ul>
<li><strong>Herwijnen</strong>: <code>RAD_NL62_VOL_NA_201712312305_ODIM.h5</code></li>
<li><strong>Den Helder</strong>: <code>RAD_NL61_VOL_NA_201712312305_ODIM.h5</code></li>
</ul>
</div>
<div id="determining-maximum-range-from-radar-to-detect-birds" class="section level2">
<h2><span class="header-section-number">1.5</span> Determining maximum range from radar to detect birds</h2>
<p>We can assume that the flight altitudes derived from <code>vol2bird</code> are representative for flight altitudes throughout the country. Given that most of the disturbance happens at comparatively low altitudes, the radar is likely to ‘overshoot’ this entirely at substantial distances away from the radar where compensating for range-effects (e.g. using Kranstauber et al. <span class="citation">(<a href="#ref-kranstauber2020">2020</a>)</span>) will thus have undesired consequences. Therefore we need to determina a maximum range at which we could still feasibly measure birds aloft. We can do so by inspecting the <code>vpts</code> plots from before, but now focussing on the lowest 1km. <em>Notice how we are generating VPTSs with 50m height bins vs. the standard 100m height bins, so we can pinpoint more precisely at what altitude densities drop off.</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">plot</span>(fw_hrw_vpts[indexes_hrw], <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/determine_range_of_overshoot-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">plot</span>(fw_dhl_vpts[indexes_dhl], <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>))</a></code></pre></div>
<p><img src="Fireworks_files/figure-html/determine_range_of_overshoot-2.png" width="672" /></p>
<p>We can now see that above <code>600m</code> ASL or so the density starts to drop substantially, so we will set this as the altitudinal cutoff to determine the range up to which we will be using the data coming from the range-bias correction <span class="citation">(Kranstauber et al. <a href="#ref-kranstauber2020">2020</a>)</span>. Although birds are somewhat lower in height overall in Den Helder than Herwijnen, this is an acceptable threshold as Herwijnen anyways covers much more land area within our study domain than Den Helder, and thus a more representative range-bias correction for Herwijnen is more important than Den Helder.</p>
<p>Now we can calculate the distance at which that height (<code>600m</code>) is the height of the lowest elevation (0.3 degrees) and round to the nearest kilometer.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">altitude_cutoff &lt;-<span class="st"> </span><span class="dv">600</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">ranges &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">180000</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">beamheights &lt;-<span class="st"> </span><span class="kw">beam_height</span>(ranges, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">nearest_index &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">abs</span>(beamheights <span class="op">-</span><span class="st"> </span>altitude_cutoff) <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(<span class="kw">abs</span>(beamheights <span class="op">-</span><span class="st"> </span>altitude_cutoff)))</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">slantrange &lt;-<span class="st"> </span>ranges[nearest_index]</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">distance_cutoff &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">round_any</span>(<span class="kw">beam_distance</span>(slantrange, <span class="fl">0.3</span>), <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">distance_cutoff</a></code></pre></div>
<pre><code>## [1] 66000</code></pre>
<p>So at roughly 66 kilometers from the radar, the lowest elevation scan pierces the sky at an altitude of 600m.</p>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-dokter_biorad_2019">
<p>Dokter, Adriaan M., Peter Desmet, Jurriaan H. Spaaks, Stijn van Hoey, Lourens Veen, Liesbeth Verlinden, Cecilia Nilsson, et al. 2019. “bioRad: Biological Analysis and Visualization of Weather Radar Data.” <em>Ecography</em> 42 (5): 852–60. <a href="https://doi.org/10.1111/ecog.04028">https://doi.org/10.1111/ecog.04028</a>.</p>
</div>
<div id="ref-kranstauber2020">
<p>Kranstauber, Bart, Willem Bouten, Hidde Leijnse, Berend-Christiaan Wijers, Liesbeth Verlinden, Judy Shamoun-Baranes, and Adriaan M Dokter. 2020. “High-Resolution Spatial Distribution of Bird Movements Estimated from a Weather Radar Network.” <em>Remote Sensing</em> 12 (4). Multidisciplinary Digital Publishing Institute: 635. <a href="https://doi.org/10.3390/rs12040635">https://doi.org/10.3390/rs12040635</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="02.Radar-data-preprocessing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/barthoekstra/fireworks/edit/master/01.Selecting-take-off-moments.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/barthoekstra/fireworks/blob/master/01.Selecting-take-off-moments.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
